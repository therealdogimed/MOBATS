module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},23515,e=>{"use strict";let t={brokers:[{id:"alpaca-1",name:"Alpaca Paper Trading",type:"Alpaca",connected:!0,equity:1e5,buyingPower:1e5,positions:0,openPositions:0,todayPL:0,pl:0,positionsList:[],lockedTradingCapital:45e3,reserveCapital:55e3,apiKey:"your-api-key",apiSecret:"your-api-secret",mode:"paper"}],strategies:[{id:"dividend-1",name:"Dividend Growth Strategy",type:"Long-term Dividend",running:!1,allocation:60,plToday:0,plTotal:0,winRate:0,stopLoss:5,takeProfit:20,maxPositionSize:1e4,aiOptimization:!0},{id:"scalping-1",name:"High-Volatility Scalper",type:"Day Trading Scalper",running:!1,allocation:40,plToday:0,plTotal:0,winRate:0,stopLoss:1,takeProfit:2,maxPositionSize:5e3,aiOptimization:!0}],plHistory:[],transactions:[],settings:{aiModel:"openai/gpt-4o",aiRiskManagement:!0,maxDrawdown:10,maxDailyLoss:1e3,defaultStopLoss:1,defaultTakeProfit:2}},r=new Map;async function a(){try{let a=t.brokers.filter(e=>"alpaca"===e.type.toLowerCase());if(0===a.length)return;for(let t of a){if("paper"===t.mode&&"live"===process.env.ALPACA_MODE){console.log("[v0] bot-state: Skipping paper account in live trading mode",{brokerId:t.id,brokerName:t.name}),t.connected=!1;continue}if(!t.apiKey||!t.apiSecret||"your-api-key"===t.apiKey||"your-api-secret"===t.apiSecret){t.connected=!1;continue}let a=r.get(t.id)||0;if(a>=3){t.connected=!1;continue}let{createAlpacaClient:i}=await e.A(12296),o=i(t.apiKey,t.apiSecret,t.mode);if(!o.isConfigured()){t.connected=!1;continue}let n=await o.verifyConnection();if(!n.success){(n.error?.includes("401")||n.error?.includes("unauthorized"))&&(r.set(t.id,a+1),a+1>=3&&console.error("[v0] bot-state: Max auth failures reached, stopping sync for broker",{brokerId:t.id,brokerName:t.name,message:"Please configure valid API credentials in the broker settings"})),t.connected=!1;continue}r.delete(t.id);let[s,l]=await Promise.all([o.getAccount(),o.getPositions()]),p=t.equity;t.equity=Number.parseFloat(s.portfolio_value),t.buyingPower=Number.parseFloat(s.buying_power),t.positions=l.length,t.openPositions=l.length,t.positionsList=l.map(e=>({symbol:e.symbol,qty:Number.parseFloat(e.qty),entryPrice:Number.parseFloat(e.market_value)/Number.parseFloat(e.qty),currentPrice:Number.parseFloat(e.market_value)/Number.parseFloat(e.qty),pl:Number.parseFloat(e.unrealized_pl),plPercent:100*Number.parseFloat(e.unrealized_plpc)}));let d=t.positionsList.reduce((e,t)=>e+t.pl,0);t.pl=d,t.todayPL=d,p!==t.equity&&(t.reserveCapital=t.equity-t.lockedTradingCapital),t.connected=!0,console.log("[v0] bot-state: Alpaca data synced successfully",{brokerId:t.id,mode:o.getMode(),equity:t.equity,buyingPower:t.buyingPower,positions:l.length})}}catch(e){console.error("[v0] bot-state: Failed to sync Alpaca data:",e)}}function i(){return t}function o(e){let r={id:`${e.type.toLowerCase()}-${Date.now()}`,name:e.name,type:e.type.toLowerCase(),connected:!1,equity:0,buyingPower:0,positions:0,openPositions:0,todayPL:0,pl:0,positionsList:[],lockedTradingCapital:0,reserveCapital:0,apiKey:e.apiKey,apiSecret:e.apiSecret,mode:e.mode||"paper"};return t.brokers.push(r),"alpaca"===r.type&&r.apiKey&&r.apiSecret&&(console.log("[v0] bot-state: New Alpaca broker added, triggering sync..."),a().catch(e=>{console.error("[v0] bot-state: New broker sync error:",e)})),r}function n(e){t.brokers=t.brokers.filter(t=>t.id!==e)}function s(e,r){let a=t.strategies.find(t=>t.id===e);a&&(a.running="start"===r)}function l(e){t.strategies.forEach(t=>{t.running="start"===e})}function p(e,r){let a=t.strategies.find(t=>t.id===e);a&&(a.allocation=r)}function d(e){t.settings={...t.settings,...e}}function c(e,r){let a=t.brokers.find(t=>t.id===e);a?(console.log("[v0] bot-state: Before update",{brokerId:e,oldLockedCapital:a.lockedTradingCapital,oldReserveCapital:a.reserveCapital,equity:a.equity,buyingPower:a.buyingPower,requestedAmount:r}),a.lockedTradingCapital=r,a.reserveCapital=a.equity-r,console.log("[v0] bot-state: After update",{brokerId:e,newLockedCapital:a.lockedTradingCapital,newReserveCapital:a.reserveCapital,equity:a.equity,buyingPower:a.buyingPower})):console.error("[v0] bot-state: Broker not found for capital update",{brokerId:e})}function u(e){let r=t.brokers.find(t=>t.id===e);if(r){let t=Math.max(r.equity,.5*r.buyingPower);r.lockedTradingCapital=.45*t,r.reserveCapital=r.equity-r.lockedTradingCapital,console.log("[v0] bot-state: Auto-locked trading capital",{brokerId:e,baseCapital:t,lockedCapital:r.lockedTradingCapital,reserveCapital:r.reserveCapital})}}function g(e){let r=t.brokers.find(t=>t.id===e);return r?{apiKey:r.apiKey,apiSecret:r.apiSecret,mode:r.mode}:null}function y(){return t.brokers.find(e=>"alpaca"===e.type.toLowerCase())||null}function f(e,i,o){let n=t.brokers.find(t=>t.id===e);n&&(n.apiKey=i,n.apiSecret=o,r.delete(e),console.log("[v0] bot-state: Broker credentials updated",{brokerId:e,hasApiKey:!!i,hasApiSecret:!!o}),"alpaca"===n.type&&i&&o&&(console.log("[v0] bot-state: Alpaca credentials updated, triggering sync..."),a().catch(e=>{console.error("[v0] bot-state: Credentials update sync error:",e)})))}e.s(["addBroker",()=>o,"getAlpacaBroker",()=>y,"getBotState",()=>i,"getBrokerCredentials",()=>g,"lockTradingCapital",()=>u,"removeBroker",()=>n,"syncAlpacaData",()=>a,"toggleAllStrategies",()=>l,"toggleStrategy",()=>s,"updateBrokerCredentials",()=>f,"updateBrokerTradingCapital",()=>c,"updateSettings",()=>d,"updateStrategyAllocation",()=>p],23515)},68795,e=>{"use strict";class t{positions=new Map;positionHistory=[];scalpingProfit=0;recordPosition(e){console.log(`[v0] Recording position: ${e.symbol} for strategy ${e.strategyName}`),this.positions.set(e.positionId,e)}updatePosition(e,t){let r=this.positions.get(e);r&&Object.assign(r,t)}closePosition(e,t,r){let a=this.positions.get(e);if(a){console.log(`[v0] Closing position ${e}: ${t}`);let i={...a,closeTimestamp:new Date().toISOString(),closeReason:t,realizedPL:r??a.unrealizedPL};this.positionHistory.push(i),(t.includes("scalp")||t.includes("profit-taking"))&&(this.scalpingProfit+=i.realizedPL,console.log(`[v0] Scalping profit updated: +$${i.realizedPL.toFixed(2)}, Total: $${this.scalpingProfit.toFixed(2)}`)),this.positions.delete(e)}}getScalpingProfit(){return this.scalpingProfit}getScalpingTradeCount(){return this.positionHistory.filter(e=>e.closeReason.includes("scalp")||e.closeReason.includes("profit-taking")).length}getPositionsByStrategy(e){return Array.from(this.positions.values()).filter(t=>t.strategyId===e)}getPosition(e){return this.positions.get(e)}getAllPositions(){return Array.from(this.positions.values())}getPositionContext(e){return Array.from(this.positions.values()).filter(t=>t.symbol===e)}hasPosition(e,t){return Array.from(this.positions.values()).some(r=>r.symbol===e&&r.strategyId===t)}}let r=null;function a(){return r||(r=new t),r}e.s(["getPositionTracker",()=>a])},92441,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),i=e.i(59756),o=e.i(61916),n=e.i(14444),s=e.i(37092),l=e.i(69741),p=e.i(16795),d=e.i(87718),c=e.i(95169),u=e.i(47587),g=e.i(66012),y=e.i(70101),f=e.i(26937),h=e.i(10372),m=e.i(93695);e.i(52474);var v=e.i(220),b=e.i(89171),k=e.i(23515),P=e.i(68795);async function C(){try{let e=(0,k.getBotState)(),t=(0,P.getPositionTracker)(),r=t.getScalpingProfit(),a=t.getScalpingTradeCount(),i=e.brokers.reduce((e,t)=>e+t.equity,0),o=e.brokers.reduce((e,t)=>e+t.pl,0),n=e.brokers.reduce((e,t)=>e+t.positions,0),s=e.strategies.filter(e=>e.running).length,l=e.brokers.reduce((e,t)=>e+t.lockedTradingCapital,0),p=e.brokers.reduce((e,t)=>e+t.reserveCapital,0),d=e.plHistory.slice(-50).map(e=>({time:new Date(e.timestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),value:e.value})),c=e.brokers.flatMap(e=>e.positionsList.map(t=>({symbol:t.symbol,qty:t.qty,entryPrice:t.entryPrice,currentPrice:t.currentPrice,pl:t.pl,plPercent:t.plPercent,broker:e.name})));return b.NextResponse.json({totalEquity:i,totalPL:o,totalPLPercent:i>0?o/i*100:0,activePositions:n,activeStrategies:s,lockedCapital:l,reserveCapital:p,plHistory:d,positions:c,brokers:e.brokers,allRunning:e.strategies.every(e=>e.running),scalpingProfit:r,scalpingTradeCount:a})}catch(e){return console.error("[v0] Dashboard error:",e),b.NextResponse.json({error:"Failed to fetch dashboard data"},{status:500})}}e.s(["GET",()=>C],4066);var w=e.i(4066);let x=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/dashboard/route",pathname:"/api/dashboard",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/dashboard/route.ts",nextConfigOutput:"",userland:w}),{workAsyncStorage:R,workUnitAsyncStorage:A,serverHooks:S}=x;function T(){return(0,a.patchFetch)({workAsyncStorage:R,workUnitAsyncStorage:A})}async function E(e,t,a){x.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let b="/api/dashboard/route";b=b.replace(/\/index$/,"")||"/";let k=await x.prepare(e,t,{srcPage:b,multiZoneDraftMode:!1});if(!k)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:P,params:C,nextConfig:w,parsedUrl:R,isDraftMode:A,prerenderManifest:S,routerServerContext:T,isOnDemandRevalidate:E,revalidateOnlyGenerated:q,resolvedPathname:N,clientReferenceManifest:L,serverActionsManifest:_}=k,O=(0,l.normalizeAppPath)(b),M=!!(S.dynamicRoutes[O]||S.routes[N]),D=async()=>((null==T?void 0:T.render404)?await T.render404(e,t,R,!1):t.end("This page could not be found"),null);if(M&&!A){let e=!!S.routes[N],t=S.dynamicRoutes[O];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await D();throw new m.NoFallbackError}}let H=null;!M||x.isDev||A||(H="/index"===(H=N)?"/":H);let I=!0===x.isDev||!M,j=M&&!I;_&&L&&(0,n.setReferenceManifestsSingleton)({page:b,clientReferenceManifest:L,serverActionsManifest:_,serverModuleMap:(0,s.createServerModuleMap)({serverActionsManifest:_})});let F=e.method||"GET",K=(0,o.getTracer)(),$=K.getActiveScopeSpan(),B={params:C,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:I,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>x.onRequestError(e,t,a,T)},sharedContext:{buildId:P}},U=new p.NodeNextRequest(e),z=new p.NodeNextResponse(t),G=d.NextRequestAdapter.fromNodeNextRequest(U,(0,d.signalFromNodeResponse)(t));try{let n=async e=>x.handle(G,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=K.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${F} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${F} ${b}`)}),s=!!(0,i.getRequestMeta)(e,"minimalMode"),l=async i=>{var o,l;let p=async({previousCacheEntry:r})=>{try{if(!s&&E&&q&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await n(i);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let p=B.renderOpts.collectedTags;if(!M)return await (0,g.sendResponse)(U,z,o,B.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,y.toNodeOutgoingHttpHeaders)(o.headers);p&&(t[h.NEXT_CACHE_TAGS_HEADER]=p),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=h.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,a=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=h.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await x.onRequestError(e,t,{routerKind:"App Router",routePath:b,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:E})},T),t}},d=await x.handleResponse({req:e,nextConfig:w,cacheKey:H,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:E,revalidateOnlyGenerated:q,responseGenerator:p,waitUntil:a.waitUntil,isMinimalMode:s});if(!M)return null;if((null==d||null==(o=d.value)?void 0:o.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",E?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,y.fromNodeOutgoingHttpHeaders)(d.value.headers);return s&&M||c.delete(h.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,f.getCacheControlHeader)(d.cacheControl)),await (0,g.sendResponse)(U,z,new Response(d.value.body,{headers:c,status:d.value.status||200})),null};$?await l($):await K.withPropagatedContext(e.headers,()=>K.trace(c.BaseServerSpan.handleRequest,{spanName:`${F} ${b}`,kind:o.SpanKind.SERVER,attributes:{"http.method":F,"http.target":e.url}},l))}catch(t){if(t instanceof m.NoFallbackError||await x.onRequestError(e,t,{routerKind:"App Router",routePath:O,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:E})}),M)throw t;return await (0,g.sendResponse)(U,z,new Response(null,{status:500})),null}}e.s(["handler",()=>E,"patchFetch",()=>T,"routeModule",()=>x,"serverHooks",()=>S,"workAsyncStorage",()=>R,"workUnitAsyncStorage",()=>A],92441)},12296,e=>{e.v(t=>Promise.all(["server/chunks/lib_alpaca-client_ts_45b176e4._.js"].map(t=>e.l(t))).then(()=>t(9108)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__300d7c36._.js.map