module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},23515,e=>{"use strict";let t={brokers:[{id:"alpaca-1",name:"Alpaca Paper Trading",type:"Alpaca",connected:!0,equity:1e5,buyingPower:1e5,positions:0,openPositions:0,todayPL:0,pl:0,positionsList:[],lockedTradingCapital:45e3,reserveCapital:55e3,apiKey:"your-api-key",apiSecret:"your-api-secret",mode:"paper"}],strategies:[{id:"dividend-1",name:"Dividend Growth Strategy",type:"Long-term Dividend",running:!1,allocation:60,plToday:0,plTotal:0,winRate:0,stopLoss:5,takeProfit:20,maxPositionSize:1e4,aiOptimization:!0},{id:"scalping-1",name:"High-Volatility Scalper",type:"Day Trading Scalper",running:!1,allocation:40,plToday:0,plTotal:0,winRate:0,stopLoss:1,takeProfit:2,maxPositionSize:5e3,aiOptimization:!0}],plHistory:[],transactions:[],settings:{aiModel:"openai/gpt-4o",aiRiskManagement:!0,maxDrawdown:10,maxDailyLoss:1e3,defaultStopLoss:1,defaultTakeProfit:2}},r=new Map;async function o(){try{let o=t.brokers.filter(e=>"alpaca"===e.type.toLowerCase());if(0===o.length)return;for(let t of o){if("paper"===t.mode&&"live"===process.env.ALPACA_MODE){console.log("[v0] bot-state: Skipping paper account in live trading mode",{brokerId:t.id,brokerName:t.name}),t.connected=!1;continue}if(!t.apiKey||!t.apiSecret||"your-api-key"===t.apiKey||"your-api-secret"===t.apiSecret){t.connected=!1;continue}let o=r.get(t.id)||0;if(o>=3){t.connected=!1;continue}let{createAlpacaClient:a}=await e.A(12296),i=a(t.apiKey,t.apiSecret,t.mode);if(!i.isConfigured()){t.connected=!1;continue}let s=await i.verifyConnection();if(!s.success){(s.error?.includes("401")||s.error?.includes("unauthorized"))&&(r.set(t.id,o+1),o+1>=3&&console.error("[v0] bot-state: Max auth failures reached, stopping sync for broker",{brokerId:t.id,brokerName:t.name,message:"Please configure valid API credentials in the broker settings"})),t.connected=!1;continue}r.delete(t.id);let[n,l]=await Promise.all([i.getAccount(),i.getPositions()]),c=t.equity;t.equity=Number.parseFloat(n.portfolio_value),t.buyingPower=Number.parseFloat(n.buying_power),t.positions=l.length,t.openPositions=l.length,t.positionsList=l.map(e=>({symbol:e.symbol,qty:Number.parseFloat(e.qty),entryPrice:Number.parseFloat(e.market_value)/Number.parseFloat(e.qty),currentPrice:Number.parseFloat(e.market_value)/Number.parseFloat(e.qty),pl:Number.parseFloat(e.unrealized_pl),plPercent:100*Number.parseFloat(e.unrealized_plpc)}));let p=t.positionsList.reduce((e,t)=>e+t.pl,0);t.pl=p,t.todayPL=p,c!==t.equity&&(t.reserveCapital=t.equity-t.lockedTradingCapital),t.connected=!0,console.log("[v0] bot-state: Alpaca data synced successfully",{brokerId:t.id,mode:i.getMode(),equity:t.equity,buyingPower:t.buyingPower,positions:l.length})}}catch(e){console.error("[v0] bot-state: Failed to sync Alpaca data:",e)}}function a(){return t}function i(e){let r={id:`${e.type.toLowerCase()}-${Date.now()}`,name:e.name,type:e.type.toLowerCase(),connected:!1,equity:0,buyingPower:0,positions:0,openPositions:0,todayPL:0,pl:0,positionsList:[],lockedTradingCapital:0,reserveCapital:0,apiKey:e.apiKey,apiSecret:e.apiSecret,mode:e.mode||"paper"};return t.brokers.push(r),"alpaca"===r.type&&r.apiKey&&r.apiSecret&&(console.log("[v0] bot-state: New Alpaca broker added, triggering sync..."),o().catch(e=>{console.error("[v0] bot-state: New broker sync error:",e)})),r}function s(e){t.brokers=t.brokers.filter(t=>t.id!==e)}function n(e,r){let o=t.strategies.find(t=>t.id===e);o&&(o.running="start"===r)}function l(e){t.strategies.forEach(t=>{t.running="start"===e})}function c(e,r){let o=t.strategies.find(t=>t.id===e);o&&(o.allocation=r)}function p(e){t.settings={...t.settings,...e}}function u(e,r){let o=t.brokers.find(t=>t.id===e);o?(console.log("[v0] bot-state: Before update",{brokerId:e,oldLockedCapital:o.lockedTradingCapital,oldReserveCapital:o.reserveCapital,equity:o.equity,buyingPower:o.buyingPower,requestedAmount:r}),o.lockedTradingCapital=r,o.reserveCapital=o.equity-r,console.log("[v0] bot-state: After update",{brokerId:e,newLockedCapital:o.lockedTradingCapital,newReserveCapital:o.reserveCapital,equity:o.equity,buyingPower:o.buyingPower})):console.error("[v0] bot-state: Broker not found for capital update",{brokerId:e})}function d(e){let r=t.brokers.find(t=>t.id===e);if(r){let t=Math.max(r.equity,.5*r.buyingPower);r.lockedTradingCapital=.45*t,r.reserveCapital=r.equity-r.lockedTradingCapital,console.log("[v0] bot-state: Auto-locked trading capital",{brokerId:e,baseCapital:t,lockedCapital:r.lockedTradingCapital,reserveCapital:r.reserveCapital})}}function g(e){let r=t.brokers.find(t=>t.id===e);return r?{apiKey:r.apiKey,apiSecret:r.apiSecret,mode:r.mode}:null}function h(){return t.brokers.find(e=>"alpaca"===e.type.toLowerCase())||null}function y(e,a,i){let s=t.brokers.find(t=>t.id===e);s&&(s.apiKey=a,s.apiSecret=i,r.delete(e),console.log("[v0] bot-state: Broker credentials updated",{brokerId:e,hasApiKey:!!a,hasApiSecret:!!i}),"alpaca"===s.type&&a&&i&&(console.log("[v0] bot-state: Alpaca credentials updated, triggering sync..."),o().catch(e=>{console.error("[v0] bot-state: Credentials update sync error:",e)})))}e.s(["addBroker",()=>i,"getAlpacaBroker",()=>h,"getBotState",()=>a,"getBrokerCredentials",()=>g,"lockTradingCapital",()=>d,"removeBroker",()=>s,"syncAlpacaData",()=>o,"toggleAllStrategies",()=>l,"toggleStrategy",()=>n,"updateBrokerCredentials",()=>y,"updateBrokerTradingCapital",()=>u,"updateSettings",()=>p,"updateStrategyAllocation",()=>c],23515)},49288,e=>{"use strict";class t{logs=[];MAX_LOGS=1e3;errorCounts=new Map;lastErrorTime=new Map;ERROR_THRESHOLD=5;ERROR_WINDOW=6e4;log(e,t,r,o,a){let i={timestamp:new Date().toISOString(),level:e,component:t,message:r,error:o?this.serializeError(o):void 0,context:a};this.logs.push(i),this.logs.length>this.MAX_LOGS&&this.logs.shift();let s=`[v0:${t}]`;"error"===e||"critical"===e?console.error(s,r,o||""):"warn"===e?console.warn(s,r):console.log(s,r),("error"===e||"critical"===e)&&this.trackError(t)}serializeError(e){return e instanceof Error?{name:e.name,message:e.message,stack:e.stack}:e}trackError(e){let t=Date.now();t-(this.lastErrorTime.get(e)||0)>this.ERROR_WINDOW&&this.errorCounts.set(e,0);let r=(this.errorCounts.get(e)||0)+1;this.errorCounts.set(e,r),this.lastErrorTime.set(e,t),r>=this.ERROR_THRESHOLD&&this.log("critical","ErrorHandler",`Component ${e} has exceeded error threshold`,null,{errorCount:r,window:this.ERROR_WINDOW})}getLogs(e){return e?this.logs.filter(t=>(!e.level||t.level===e.level)&&(!e.component||t.component===e.component)):[...this.logs]}clearLogs(){this.logs=[],this.errorCounts.clear(),this.lastErrorTime.clear()}getErrorCount(e){return this.errorCounts.get(e)||0}}let r=null;function o(){return r||(r=new t),r}e.s(["getErrorHandler",()=>o])},5113,e=>{"use strict";class t{sources=new Map;signalCache=new Map;MAX_ERROR_COUNT=5;CACHE_TTL=6e4;async addSource(e){console.log(`[v0] Adding data source: ${e.name}`),this.sources.set(e.id,e)}async removeSource(e){console.log(`[v0] Removing data source: ${e}`),this.sources.delete(e),this.signalCache.delete(e)}async fetchSignals(e){let t=[];for(let[r,o]of this.sources.entries())if(o.enabled&&!(o.errorCount>=this.MAX_ERROR_COUNT))try{let r=await this.fetchFromSource(o,e);t.push(...r),o.errorCount=0,o.lastFetch=new Date().toISOString()}catch(e){console.error(`[v0] Data source ${o.name} error:`,e),o.errorCount++,o.errorCount>=this.MAX_ERROR_COUNT&&(console.log(`[v0] Disabling data source ${o.name} due to repeated errors`),o.enabled=!1)}return this.signalCache.set(e,t),t}async fetchFromSource(e,t){return[]}getCachedSignals(e){return this.signalCache.get(e)||[]}getSources(){return Array.from(this.sources.values())}}let r=null;function o(){return r||(r=new t),r}e.s(["getDataSourceManager",()=>o])},84199,(e,t,r)=>{"use strict";var o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,n={},l={VercelOidcTokenError:()=>p};for(var c in l)o(n,c,{get:l[c],enumerable:!0});t.exports=((e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of i(t))s.call(e,r)||void 0===r||o(e,r,{get:()=>t[r],enumerable:!(n=a(t,r))||n.enumerable});return e})(o({},"__esModule",{value:!0}),n);class p extends Error{constructor(e,t){super(e),this.name="VercelOidcTokenError",this.cause=t}toString(){return this.cause?`${this.name}: ${this.message}: ${this.cause}`:`${this.name}: ${this.message}`}}},68795,e=>{"use strict";class t{positions=new Map;positionHistory=[];scalpingProfit=0;recordPosition(e){console.log(`[v0] Recording position: ${e.symbol} for strategy ${e.strategyName}`),this.positions.set(e.positionId,e)}updatePosition(e,t){let r=this.positions.get(e);r&&Object.assign(r,t)}closePosition(e,t,r){let o=this.positions.get(e);if(o){console.log(`[v0] Closing position ${e}: ${t}`);let a={...o,closeTimestamp:new Date().toISOString(),closeReason:t,realizedPL:r??o.unrealizedPL};this.positionHistory.push(a),(t.includes("scalp")||t.includes("profit-taking"))&&(this.scalpingProfit+=a.realizedPL,console.log(`[v0] Scalping profit updated: +$${a.realizedPL.toFixed(2)}, Total: $${this.scalpingProfit.toFixed(2)}`)),this.positions.delete(e)}}getScalpingProfit(){return this.scalpingProfit}getScalpingTradeCount(){return this.positionHistory.filter(e=>e.closeReason.includes("scalp")||e.closeReason.includes("profit-taking")).length}getPositionsByStrategy(e){return Array.from(this.positions.values()).filter(t=>t.strategyId===e)}getPosition(e){return this.positions.get(e)}getAllPositions(){return Array.from(this.positions.values())}getPositionContext(e){return Array.from(this.positions.values()).filter(t=>t.symbol===e)}hasPosition(e,t){return Array.from(this.positions.values()).some(r=>r.symbol===e&&r.strategyId===t)}}let r=null;function o(){return r||(r=new t),r}e.s(["getPositionTracker",()=>o])},11251,e=>{"use strict";var t=e.i(47909),r=e.i(74017),o=e.i(96250),a=e.i(59756),i=e.i(61916),s=e.i(14444),n=e.i(37092),l=e.i(69741),c=e.i(16795),p=e.i(87718),u=e.i(95169),d=e.i(47587),g=e.i(66012),h=e.i(70101),y=e.i(26937),f=e.i(10372),m=e.i(93695);e.i(52474);var v=e.i(220),b=e.i(89171),C=e.i(76969),R=e.i(49288);async function w(){try{let e=(0,C.getStrategyEngine)().getStrategies();return b.NextResponse.json({strategies:e})}catch(e){return(0,R.getErrorHandler)().log("error","StrategiesAPI","Failed to fetch strategies",e),b.NextResponse.json({error:"Failed to fetch strategies"},{status:500})}}e.s(["GET",()=>w],49182);var k=e.i(49182);let P=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/strategies/route",pathname:"/api/strategies",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/strategies/route.ts",nextConfigOutput:"",userland:k}),{workAsyncStorage:x,workUnitAsyncStorage:E,serverHooks:S}=P;function A(){return(0,o.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:E})}async function T(e,t,o){P.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let b="/api/strategies/route";b=b.replace(/\/index$/,"")||"/";let C=await P.prepare(e,t,{srcPage:b,multiZoneDraftMode:!1});if(!C)return t.statusCode=400,t.end("Bad Request"),null==o.waitUntil||o.waitUntil.call(o,Promise.resolve()),null;let{buildId:R,params:w,nextConfig:k,parsedUrl:x,isDraftMode:E,prerenderManifest:S,routerServerContext:A,isOnDemandRevalidate:T,revalidateOnlyGenerated:O,resolvedPathname:_,clientReferenceManifest:N,serverActionsManifest:q}=C,L=(0,l.normalizeAppPath)(b),M=!!(S.dynamicRoutes[L]||S.routes[_]),D=async()=>((null==A?void 0:A.render404)?await A.render404(e,t,x,!1):t.end("This page could not be found"),null);if(M&&!E){let e=!!S.routes[_],t=S.dynamicRoutes[L];if(t&&!1===t.fallback&&!e){if(k.experimental.adapterPath)return await D();throw new m.NoFallbackError}}let H=null;!M||P.isDev||E||(H="/index"===(H=_)?"/":H);let $=!0===P.isDev||!M,I=M&&!$;q&&N&&(0,s.setReferenceManifestsSingleton)({page:b,clientReferenceManifest:N,serverActionsManifest:q,serverModuleMap:(0,n.createServerModuleMap)({serverActionsManifest:q})});let j=e.method||"GET",F=(0,i.getTracer)(),K=F.getActiveScopeSpan(),U={params:w,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!k.experimental.authInterrupts},cacheComponents:!!k.cacheComponents,supportsDynamicResponse:$,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:k.cacheLife,waitUntil:o.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,o)=>P.onRequestError(e,t,o,A)},sharedContext:{buildId:R}},B=new c.NodeNextRequest(e),z=new c.NodeNextResponse(t),W=p.NextRequestAdapter.fromNodeNextRequest(B,(0,p.signalFromNodeResponse)(t));try{let s=async e=>P.handle(W,U).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=F.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=r.get("next.route");if(o){let t=`${j} ${o}`;e.setAttributes({"next.route":o,"http.route":o,"next.span_name":t}),e.updateName(t)}else e.updateName(`${j} ${b}`)}),n=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var i,l;let c=async({previousCacheEntry:r})=>{try{if(!n&&T&&O&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(a);e.fetchMetrics=U.renderOpts.fetchMetrics;let l=U.renderOpts.pendingWaitUntil;l&&o.waitUntil&&(o.waitUntil(l),l=void 0);let c=U.renderOpts.collectedTags;if(!M)return await (0,g.sendResponse)(B,z,i,U.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(i.headers);c&&(t[f.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==U.renderOpts.collectedRevalidate&&!(U.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&U.renderOpts.collectedRevalidate,o=void 0===U.renderOpts.collectedExpire||U.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:U.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:o}}}}catch(t){throw(null==r?void 0:r.isStale)&&await P.onRequestError(e,t,{routerKind:"App Router",routePath:b,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:I,isOnDemandRevalidate:T})},A),t}},p=await P.handleResponse({req:e,nextConfig:k,cacheKey:H,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:O,responseGenerator:c,waitUntil:o.waitUntil,isMinimalMode:n});if(!M)return null;if((null==p||null==(i=p.value)?void 0:i.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(l=p.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});n||t.setHeader("x-nextjs-cache",T?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,h.fromNodeOutgoingHttpHeaders)(p.value.headers);return n&&M||u.delete(f.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,y.getCacheControlHeader)(p.cacheControl)),await (0,g.sendResponse)(B,z,new Response(p.value.body,{headers:u,status:p.value.status||200})),null};K?await l(K):await F.withPropagatedContext(e.headers,()=>F.trace(u.BaseServerSpan.handleRequest,{spanName:`${j} ${b}`,kind:i.SpanKind.SERVER,attributes:{"http.method":j,"http.target":e.url}},l))}catch(t){if(t instanceof m.NoFallbackError||await P.onRequestError(e,t,{routerKind:"App Router",routePath:L,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:I,isOnDemandRevalidate:T})}),M)throw t;return await (0,g.sendResponse)(B,z,new Response(null,{status:500})),null}}e.s(["handler",()=>T,"patchFetch",()=>A,"routeModule",()=>P,"serverHooks",()=>S,"workAsyncStorage",()=>x,"workUnitAsyncStorage",()=>E],11251)},67030,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__0983279f._.js"].map(t=>e.l(t))).then(()=>t(83697)))},83671,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__0ea05e0c._.js"].map(t=>e.l(t))).then(()=>t(90391)))},12296,e=>{e.v(t=>Promise.all(["server/chunks/lib_alpaca-client_ts_45b176e4._.js"].map(t=>e.l(t))).then(()=>t(9108)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__a2b65011._.js.map